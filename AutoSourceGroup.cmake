function(AUTO_SOURCE_GROUP FILTER FILES)
  foreach(AUTO_SOURCE_GROUP_FILE ${FILES})
    get_filename_component(AUTO_SOURCE_GROUP_FILE "${AUTO_SOURCE_GROUP_FILE}" ABSOLUTE)
    get_filename_component(AUTO_SOURCE_GROUP_FOLDER "${AUTO_SOURCE_GROUP_FILE}" DIRECTORY)
    file(RELATIVE_PATH AUTO_SOURCE_GROUP_FOLDER "${CMAKE_CURRENT_SOURCE_DIR}" "${AUTO_SOURCE_GROUP_FOLDER}")
    file(RELATIVE_PATH AUTO_SOURCE_GROUP_FILE "${CMAKE_CURRENT_SOURCE_DIR}" "${AUTO_SOURCE_GROUP_FILE}")
    string(REPLACE "../" "..\\" AUTO_SOURCE_GROUP_FILTER "${AUTO_SOURCE_GROUP_FOLDER}")
    string(REPLACE "./" "" AUTO_SOURCE_GROUP_FILTER "${AUTO_SOURCE_GROUP_FILTER}")
    string(REPLACE "/" "\\" AUTO_SOURCE_GROUP_FILTER "${AUTO_SOURCE_GROUP_FILTER}")
    string(REPLACE "..\\" "../" AUTO_SOURCE_GROUP_FILTER "${AUTO_SOURCE_GROUP_FILTER}")
    if("${AUTO_SOURCE_GROUP_FILTER}" MATCHES "(.+)/$")
      set(AUTO_SOURCE_GROUP_FILTER "${CMAKE_MATCH_1}")
    endif()
    if("${AUTO_SOURCE_GROUP_FILTER}" STREQUAL ".")
      source_group("${FILTER}" FILES ${AUTO_SOURCE_GROUP_FILE})
    else()
      source_group("${FILTER}\\${AUTO_SOURCE_GROUP_FILTER}" FILES ${AUTO_SOURCE_GROUP_FILE})
    endif()
  endforeach()
endfunction()
